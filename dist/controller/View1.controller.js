sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/core/util/Export","sap/ui/core/util/ExportTypeCSV","sap/m/Token","../model/formatter","sap/ui/export/Spreadsheet","sap/m/MessageToast","sap/ui/core/Fragment"],function(e,t,s,a,r,i,o,l,n){"use strict";return e.extend("incture.com.ConnectClientCustomeEnquiry.controller.View1",{onInit:function(){var e=new t;this.getView().setModel(e,"oModel");var s=new sap.ui.model.json.JSONModel;this.getView().setModel(s,"baseModel");this.getView().getModel("baseModel").setProperty("/openVisiblity",false);this.getView().getModel("baseModel").setProperty("/CollapseVisiblity",true);this.getView().getModel("baseModel").setProperty("/SearchVisiblity",true);var a=this;this.allAccess=true;this.getLoggedInUserDetail();this.salesOrgFromSelectedItems=[];this.SoldToPartyModel=new sap.ui.model.json.JSONModel({CustId:"",CustIdDesc:"",CustName:"",CustNameDesc:"",Division:"",DivisionDesc:"",SalesOrgDesc:"",DistChan:"",DistChanDesc:"",SalesOrg:""});this.getView().setModel(this.SoldToPartyModel,"SoldToPartyModSet");this.salesHdrData={Category:"",customerPo:"",SoldtoParty:"",SoldtoPartyDesc:"",SalesDocNumInitial:"",SalesDocNumEnd:"",MatGrp4:"",SalesDocDateFrom:null,SalesDocDateTo:null,DistChan:"",DistChanDesc:"",MatGrp:"",salesOrg:"",division:"",CustomerNo:"",itemDeliveryBlock:"",shipToParty:"",headerDlvBlock:"",sapMaterialNum:""};this.SalesHdrModel=new sap.ui.model.json.JSONModel(this.salesHdrData);this.getView().setModel(this.SalesHdrModel,"SaleHdrModelSet")},getLoggedInUserDetail:function(){var e;var t=this;$.ajax({type:"GET",async:false,url:"/services/userapi/currentUser",contentType:"application/scim+json",success:function(s,a,r){var i=new sap.ui.model.json.JSONModel(s);t.getView().setModel(i,"userapi");e=t.getView().getModel("userapi").getData().name;t.userID=e;t.getAttributeDetails(e)},error:function(e){sap.m.MessageBox.error(t.getView().getModel("i18n").getProperty("retrieveDetails"))},complete:function(e){}});return e},getAttributeDetails:function(e){var t=this;$.ajax({type:"GET",async:false,url:"/DKSHJavaService/userDetails/findAllRightsForUserInDomain/"+e+"&cc",contentType:"application/scim+json",success:function(e,s,a){if(e.message)t.allAccess=false;t.salesOrgDataAccess=e.ATR01;t.distrChannelDataAccess=e.ATR02;t.divisionDataAccess=e.ATR03;t.materialGroupDataAccess=e.ATR04;t.materialGroup4DataAccess=e.ATR05;t.custCodeDataAccess=e.ATR06},error:function(e){t.salesOrgDataAccess=null;t.distrChannelDataAccess=null;t.divisionDataAccess=null;t.materialGroupDataAccess=null;t.materialGroup4DataAccess=null;t.custCodeDataAccess=null;if(e.status==409)t.allAccess=false;else sap.m.MessageBox.error("Could not retrieve logged in user details")},complete:function(e){}})},getLoggedInUserName:function(e){var t=this;var s=new sap.ui.model.json.JSONModel;t.getView().setModel(s,"oLoggedInUserDetailModel");s.loadData("/IDPService/service/scim/Users/"+e,null,true);s.attachRequestCompleted(function(e){var s=e.getSource().getData()["urn:sap:cloud:scim:schemas:extension:custom:2.0:User"];if(s==undefined){}else{if(s.attributes[0]!==undefined){t.salesOrgDataAccess=s.attributes[0].value}else{t.salesOrgDataAccess="No Access"}if(s.attributes[2]!==undefined){t.distrChannelDataAccess=s.attributes[2].value}else{t.distrChannelDataAccess="No Access"}if(s.attributes[3]!==undefined){t.divisionDataAccess=s.attributes[3].value}else{t.divisionDataAccess="No Access"}if(s.attributes[4]!==undefined){t.materialGroupDataAccess=s.attributes[4].value}else{t.materialGroupDataAccess="No Access"}if(s.attributes[5]!==undefined){t.materialGroup4DataAccess=s.attributes[5].value}else{t.materialGroup4DataAccess="No Access"}if(s.attributes[6]!==undefined){t.custCodeDataAccess=s.attributes[6].value}else{t.custCodeDataAccess="No Access"}}var a=e.getSource().getData().id;t.getView().getModel("oLoggedInUserDetailModel").setProperty("/userLoginId",a);var r=e.getSource().getData().name;t.getView().getModel("oLoggedInUserDetailModel").setProperty("/loggedInUser",r.givenName+" "+r.familyName);var i=e.getSource().getData().emails["0"].value;t.getView().getModel("oLoggedInUserDetailModel").setProperty("/loggedInUserMail",i)});s.attachRequestFailed(function(e){})},onSearchSoldToParty:function(e){var t=this,s=new sap.ui.model.json.JSONModel({results:[]}),a=this.getView().getModel("SoldToPartyModSet").getData(),r=[];t.CustCodeFrag.setModel(s,"SoldToPartyListSet");sap.ui.getCore().byId("idFrgCustID").setValueState(sap.ui.core.ValueState.None);if(a.CustId===""&&a.CustIdDesc===""&&a.CustName===""&&a.CustNameDesc===""&&a.Division===""&&a.DivisionDesc===""&&a.SalesOrgDesc===""&&a.DistChan===""&&a.DistChanDesc===""&&a.SalesOrg===""){sap.m.MessageBox.error(this.getView().getModel("i18n").getProperty("enterAtleastOne"));return}if(a.CustId!==""){r.push(new sap.ui.model.Filter("CustCode",sap.ui.model.FilterOperator.EQ,a.CustId))}if(a.CustNameDesc!==""){r.push(new sap.ui.model.Filter("Name1",sap.ui.model.FilterOperator.EQ,a.CustNameDesc))}if(a.DistChan!==""){r.push(new sap.ui.model.Filter("Distchl",sap.ui.model.FilterOperator.EQ,a.DistChan))}else{r.push(new sap.ui.model.Filter("Distchl",sap.ui.model.FilterOperator.EQ,t.distrChannelDataAccess))}if(a.Division!==""){r.push(new sap.ui.model.Filter("Division",sap.ui.model.FilterOperator.EQ,a.Division))}else{r.push(new sap.ui.model.Filter("Division",sap.ui.model.FilterOperator.EQ,t.divisionDataAccess))}if(a.SalesOrg!==""){r.push(new sap.ui.model.Filter("SalesOrg",sap.ui.model.FilterOperator.EQ,a.SalesOrg))}else{r.push(new sap.ui.model.Filter("SalesOrg",sap.ui.model.FilterOperator.EQ,t.salesOrgDataAccess))}var i=this.getView().getModel("ZDKSH_CC_DAC_SOLDTOPARTY_SRV");var o=new sap.m.BusyDialog;o.open();i.read("/ZSoldToPartySH",{async:false,filters:r,success:function(e,s){o.close();t.CustCodeFrag.getModel("SoldToPartyListSet").setData({results:e.results})},error:function(e){o.close();var s="";if(e.statusCode===504){s=t.getView().getModel("i18n").getProperty("timeout");sap.m.MessageToast.error(s)}else{s=JSON.parse(e.responseText);s=s.error.message.value;sap.m.MessageToast.error(s)}}})},onSubmitSoldtoParty:function(e){var t=sap.ui.getCore().byId("idSoldtoPartyTable");if(t.getItems().length>0&&t.getSelectedContextPaths().length>0){var s=t.getSelectedItem().getBindingContext("SoldToPartyListSet");var a=this.getView().getModel("SaleHdrModelSet").getData();a.SoldtoParty=s.getProperty("CustCode");a.SoldtoPartyDesc=s.getProperty("Name1");a.DistChan=s.getProperty("Distchl");a.DistChanDesc=s.getProperty("DCName");a.salesOrg=s.getProperty("SalesOrg");a.SalesOrgDesc=s.getProperty("SOrgName");a.division=s.getProperty("Division");a.DivisionDesc=s.getProperty("DName");this.getView().getModel("SaleHdrModelSet").refresh();this.onResetSoldToParty();this.getView().getModel("oModel").setProperty("/custCode",a.SoldtoParty);this.CustCodeFrag.close()}else{sap.m.MessageBox.error(this.getView().getModel("i18n").getProperty("selectAtleastOne"))}},valueHelpRequestCustCode:function(e){var t=this;if(!t.custCodeDataAccess){sap.m.MessageToast.show(this.getView().getModel("i18n").getProperty("DataAccessControl"))}else{if(!t.CustCodeFrag){t.CustCodeFrag=sap.ui.xmlfragment("incture.com.ConnectClientCustomeEnquiry.view.Fragments.soldTo",this);t.getView().addDependent(t.CustCodeFrag);t.CustCodeFrag.addStyleClass("sapUiSizeCompact")}sap.ui.getCore().byId("idFrgCustID").setValueState(sap.ui.core.ValueState.None);sap.ui.getCore().byId("idSearchSoldToParty").setValue("");t.CustCodeFrag.open()}},valueHelpRequestDistChan:function(e){var t=this;this.distChnlInputId=e.getSource().getId();if(!t.distrChannelDataAccess){sap.m.MessageToast.show(this.getView().getModel("i18n").getProperty("DataAccessControl"))}else{if(!t.DistChanFrag){t.DistChanFrag=sap.ui.xmlfragment("incture.com.ConnectClientCustomeEnquiry.view.Fragments.DistChan",t);t.getView().addDependent(t.DistChanFrag);var s=this.getView().getModel("ODataNewService");var a=[];var r="";if(sap.ushell&&sap.ushell.Container){r=sap.ui.getCore().getConfiguration().getLanguage()}else{r="EN"}r=r.toUpperCase();var i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("Language",sap.ui.model.FilterOperator.EQ,r),new sap.ui.model.Filter("DistChl",sap.ui.model.FilterOperator.EQ,t.distrChannelDataAccess)],and:true});a.push(i);var o=new sap.m.BusyDialog;o.open();s.read("/ZDISTCHLLOOKUPSet",{async:false,filters:a,success:function(e,s){o.close();var a=new sap.ui.model.json.JSONModel({results:e.results});t.DistChanFrag.setModel(a,"DistChanSet");t.DistChanFrag.open()},error:function(e){o.close();var s="";if(e.statusCode===504){s=t.getView().getModel("i18n").getProperty("timeout");sap.m.MessageToast.error(s)}else{s=JSON.parse(e.responseText);s=s.error.message.value;sap.m.MessageToast.error(s)}}})}else{t.DistChanFrag.open()}}},handleAddDistChan:function(e){var t=e.getParameters().selectedContexts[0].getObject();if(this.distChnlInputId==="idDistChanCC"){var s=this.getView().getModel("SoldToPartyModSet");s.getData().DistChan=t.DistChl;s.getData().DistChanDesc=t.Name;s.refresh()}else{var a=this.getView().getModel("SaleHdrModelSet");a.getData().DistChan=t.DistChl;a.getData().DistChanDesc=t.Name;a.refresh()}e.getSource().getBinding("items").filter([])},onLiveChangestorageLoc:function(e){var t=e.getParameters().value;var s=[];var a=new sap.ui.model.Filter([new sap.ui.model.Filter("Lgort",sap.ui.model.FilterOperator.Contains,t)]);s.push(a);var r=e.getSource().getBinding("items");r.filter(s)},handleCancelDistChan:function(e){e.getSource().getBinding("items").filter([])},valueHelpRequestSalesOrg:function(e){this.salesOrgInputId=e.getSource().getId();var t=this;if(!t.salesOrgDataAccess){sap.m.MessageToast.show(this.getView().getModel("i18n").getProperty("DataAccessControl"))}else{if(!t.SalesOrgFrag1){t.SalesOrgFrag1=sap.ui.xmlfragment("incture.com.ConnectClientCustomeEnquiry.view.Fragments.SalesOrgSingle",t);t.getView().addDependent(t.SalesOrgFrag1);var s=this.getView().getModel("ODataNewService");var a="";if(sap.ushell&&sap.ushell.Container){a=sap.ui.getCore().getConfiguration().getLanguage()}else{a="EN"}a=a.toUpperCase();var r=[];var i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("Language",sap.ui.model.FilterOperator.EQ,a),new sap.ui.model.Filter("SalesOrg",sap.ui.model.FilterOperator.EQ,t.salesOrgDataAccess)],and:true});r.push(i);var o=new sap.m.BusyDialog;o.open();s.read("/ZSALESORGLOOKUPSet",{async:true,filters:r,success:function(e,s){o.close();var a=new sap.ui.model.json.JSONModel({results:e.results});t.SalesOrgFrag1.setModel(a,"SalesOrgSet1");t.SalesOrgFrag1.open()},error:function(e){o.close();var s="";if(e.statusCode===504){s=t.getView().getModel("i18n").getProperty("timeout");sap.m.MessageToast.error(s)}else{s=JSON.parse(e.responseText);s=s.error.message.value;sap.m.MessageToast.error(s)}}})}else{t.SalesOrgFrag1.open()}}},handleAddSalesOrg:function(e){var t=e.getParameters().selectedContexts[0].getObject();if(this.salesOrgInputId==="idFrgQty"){var s=this.getView().getModel("SoldToPartyModSet");s.getData().SalesOrg=t.SalesOrg;s.getData().SalesOrgDesc=t.Name;s.refresh()}else{var a=this.getView().getModel("SaleHdrModelSet");a.getData().salesOrg=t.SalesOrg;a.getData().SalesOrgDesc=t.Name;a.refresh()}e.getSource().getBinding("items").filter([])},handleCancelSalesOrg:function(e){e.getSource().getBinding("items").filter([])},onLiveChangeSalesOrg:function(e){var t=e.getParameters().value;var s=new Array;var a=new sap.ui.model.Filter([new sap.ui.model.Filter("SalesOrg",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("Name",sap.ui.model.FilterOperator.Contains,t)]);s.push(a);var r=e.getSource().getBinding("items");r.filter(s)},fnLiveChangeSalesOrg:function(e){var t=e.getParameters().value;var s=new Array;var a=new sap.ui.model.Filter([new sap.ui.model.Filter("Salesorg",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("SalesorgDesc",sap.ui.model.FilterOperator.Contains,t)]);s.push(a);var r=e.getSource().getBinding("items");r.filter(s)},valueHelpRequestDivision:function(e){this.divisionInputId=e.getSource().getId();var t=this;if(!t.divisionDataAccess){sap.m.MessageToast.show(this.getView().getModel("i18n").getProperty("DataAccessControl"))}else{if(!t.DivisionFrag){t.DivisionFrag=sap.ui.xmlfragment("incture.com.ConnectClientCustomeEnquiry.view.Fragments.Division",t);t.getView().addDependent(t.DivisionFrag);var s=this.getView().getModel("ODataNewService");var a=[];var r="";if(sap.ushell&&sap.ushell.Container){r=sap.ui.getCore().getConfiguration().getLanguage()}else{r="EN"}r=r.toUpperCase();var i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("Language",sap.ui.model.FilterOperator.EQ,r),new sap.ui.model.Filter("Division",sap.ui.model.FilterOperator.EQ,t.divisionDataAccess)],and:true});a.push(i);var o=new sap.m.BusyDialog;o.open();s.read("/ZDIVISIONLOOKUPSet",{async:false,filters:a,success:function(e,s){o.close();var a=new sap.ui.model.json.JSONModel({results:e.results});t.DivisionFrag.setModel(a,"DivisionSet");t.DivisionFrag.open()},error:function(e){o.close();var s="";if(e.statusCode===504){s=t.getView().getModel("i18n").getProperty("timeout");sap.m.MessageToast.error(s)}else{s=JSON.parse(e.responseText);s=s.error.message.value;sap.m.MessageToast.error(s)}}})}else{t.DivisionFrag.open()}}},handleAddDivision:function(e){var t=e.getParameters().selectedContexts[0].getObject();if(this.divisionInputId==="idFrgPrice"){var s=this.getView().getModel("SoldToPartyModSet");s.getData().Division=t.Division;s.getData().DivisionDesc=t.Name;s.refresh()}else{var a=this.getView().getModel("SaleHdrModelSet");a.getData().division=t.Division;a.getData().DivisionDesc=t.Name;a.refresh()}e.getSource().getBinding("items").filter([])},handleCancelDivision:function(e){e.getSource().getBinding("items").filter([])},onLiveChangeDivision:function(e){var t=e.getParameters().value;var s=new Array;var a=new sap.ui.model.Filter([new sap.ui.model.Filter("Division",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("Name",sap.ui.model.FilterOperator.Contains,t)]);s.push(a);var r=e.getSource().getBinding("items");r.filter(s)},salesOrgValueHelp:function(e){this.salesOrgPlaceholder=e.getSource().getPlaceholder();var t=this;if(!t.salesOrgDataAccess){sap.m.MessageToast.show(this.getView().getModel("i18n").getProperty("DataAccessControl"))}else{if(!t.salesOrg){t.salesOrg=sap.ui.xmlfragment("incture.com.ConnectClientCustomeEnquiry.view.Fragments.SalesOrg",t);t.getView().addDependent(t.salesOrg);var s=this.getView().getModel("ZDKSH_CC_INVENTORY_HDRLOOKUP_SRV");var a=[];var r="";if(sap.ushell){if(sap.ui.getCore().getConfiguration().getLanguage()==="th"){r="2"}else{r="EN"}}else{r="EN"}r=r.toUpperCase();var i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("Language",sap.ui.model.FilterOperator.EQ,r),new sap.ui.model.Filter("Salesorg",sap.ui.model.FilterOperator.EQ,t.salesOrgDataAccess)],and:true});a.push(i);var o=new sap.m.BusyDialog;o.open();s.read("/ZSearchHelp_SalesOrgSet",{async:false,filters:a,success:function(e,s){o.close();var a=new sap.ui.model.json.JSONModel({results:e.results});t.salesOrg.setModel(a,"salesOrgModel");t.salesOrg.open()},error:function(e){o.close();var s="";if(e.statusCode===504){s=t.getView().getModel("i18n").getProperty("timeout");sap.m.MessageToast.error(s)}else{s=JSON.parse(e.responseText);s=s.error.message.value;sap.m.MessageToast.error(s)}}})}else{t.salesOrg.open()}}},onClear:function(){var e=this.getView().getModel("oModel");e.setData({custCode:"",oldCustCode:"",salesOrg:""});this.getView().byId("searchField").setValue("");this.getView().byId("ATPSalesOrgFromID").destroyTokens();this.salesOrgFromSelectedItems=[];e.refresh();var t=this.getView().getModel("oTableModel");if(t){t.setData();t.refresh()}},mandatoryCheck:function(e){if(e.custCode||e.name||e.oldCustCode)return true;else{sap.m.MessageBox.information(this.getView().getModel("i18n").getProperty("enterApartsorg"));return false}},onRowSelect:function(e){if(this.getView().getModel("device").getProperty("/system/phone")){var t=new sap.ui.model.json.JSONModel;var s=this.getView().byId("tableId").getModel("oTableModel");var a=s.getProperty(e.getSource().getBindingContext("oTableModel").sPath);var r={postCode:a.postCode,salesOrg:incture.com.MaterialEnquiry.model.formatter.f4ValueBind(a.salesOrg,a.sOrgName)};var i=e.getSource();if(!this._oPopover){n.load({name:"incture.com.ConnectClientCustomeEnquiry.view.Fragments.popOver",controller:this}).then(function(e){this._oPopover=e;this.getView().addDependent(this._oPopover);r=r;t.setData(r);this._oPopover.setModel(t,"tblModel");this._oPopover.openBy(i)}.bind(this))}else{r=r;t.setData(r);this._oPopover.setModel(t,"tblModel");this._oPopover.openBy(i)}}},onConfirmChangeSalesOrg:function(e){this.getView().getModel("oModel").getData().SalesOrgValueState="None";e.getSource().getBinding("items").filter([]);var t=this.byId("ATPSalesOrgFromID");this.salesOrgFromSelectedItems=[];if(e.getParameters().selectedContexts.length>0){for(var s=0;s<e.getParameters().selectedContexts.length;s++){this.salesOrgFromSelectedItems.push(e.getParameters().selectedContexts[s].getObject().Salesorg);t.addToken(new r({text:e.getParameters().selectedContexts[s].getObject().Salesorg}))}}else{sap.m.MessageBox.error(this.getView().getModel("i18n").getProperty("selectAtleastOne"))}},onCancelValueHelp:function(e){e.getSource().getBinding("items").filter([])},onSearch:function(){if(!this.allAccess){sap.m.MessageToast.show(this.getView().getModel("i18n").getProperty("DataAccessControl"))}else{var e=this.getView().getModel("oModel"),t=e.getData();if(this.mandatoryCheck(t)){var s=this.getView().getModel("ZDKSH_CC_MASTER_ENQUIRIES_SRV");var a=[],r=[],i,o=[];if(this.salesOrgFromSelectedItems.length>0){for(var l=0;l<this.salesOrgFromSelectedItems.length;l++){o.push(new sap.ui.model.Filter("salesOrg",sap.ui.model.FilterOperator.EQ,this.salesOrgFromSelectedItems[l]))}var n=new sap.ui.model.Filter({filters:o,or:true})}if(sap.ushell&&sap.ushell.Container){i=sap.ui.getCore().getConfiguration().getLanguage();if(i.toLowerCase()=="en")i="E";else i=2}else{i="E"}if(this.distrChannelDataAccess){r.push(new sap.ui.model.Filter("channel",sap.ui.model.FilterOperator.EQ,this.distrChannelDataAccess))}if(this.custCodeDataAccess&&this.custCodeDataAccess!="*"){r.push(new sap.ui.model.Filter("custNumEx",sap.ui.model.FilterOperator.EQ,this.custCodeDataAccess))}if(this.divisionDataAccess){r.push(new sap.ui.model.Filter("division",sap.ui.model.FilterOperator.EQ,this.divisionDataAccess))}if(t.custCode)r.push(new sap.ui.model.Filter("custCode",sap.ui.model.FilterOperator.EQ,t.custCode));if(this.salesOrgFromSelectedItems.length>0)r.push(n);else r.push(new sap.ui.model.Filter("salesOrg",sap.ui.model.FilterOperator.EQ,this.salesOrgDataAccess));if(t.oldCustCode)r.push(new sap.ui.model.Filter("oldCustCode",sap.ui.model.FilterOperator.EQ,t.oldCustCode));if(t.name)r.push(new sap.ui.model.Filter("nameInEN",sap.ui.model.FilterOperator.EQ,"*"+t.name+"*"));var d=this;var g=new sap.m.BusyDialog;g.open();s.read("/CustomerMasterSet",{async:false,filters:r,success:function(e,t){var s=new sap.ui.model.json.JSONModel;s.setSizeLimit(e.results.length);d.getView().setModel(s,"oTableModel");s.setData(e);d.getView().byId("searchField").setValue("");if(e.results.length>0){d.getView().byId("exportId").setEnabled(true);s.setSizeLimit(e.results.length)}else{d.getView().byId("exportId").setEnabled(false)}g.close()},error:function(e){var t=new sap.ui.model.json.JSONModel;d.getView().setModel(t,"oTableModel");t.setData("");g.close();var s="";if(e.responseText.includes("abnormal terminated")){s=d.getView().getModel("i18n").getProperty("timeout");sap.m.MessageBox.error(s)}else if(e.status==504){s=d.getView().getModel("i18n").getProperty("dataNotFound");sap.m.MessageBox.error(s)}else{s=JSON.parse(e.responseText);s=s.error.message.value;sap.m.MessageBox.error(s)}}})}}},onCancelSoldtoParty:function(e){this.CustCodeFrag.close();this.onResetSoldToParty()},onDeleteSalesOrg:function(e){if(e.getParameters().type==="removed"){var t=e.getParameters().removedTokens[0].mProperties.text;for(var s=this.salesOrgFromSelectedItems.length;s>=0;s--){if(t===this.salesOrgFromSelectedItems[s]){this.salesOrgFromSelectedItems.splice(s,1)}}}else{this.salesOrgFromSelectedItems.push(e.getParameters().addedTokens[0].getText())}},onResetSoldToParty:function(e){this.getView().getModel("SoldToPartyModSet").setData({CustId:"",CustIdDesc:"",CustName:"",CustNameDesc:"",Division:"",DivisionDesc:"",SalesOrg:"",SalesOrgDesc:"",DistChan:"",DistChanDesc:"",sapMaterialNum:""});this.getView().getModel("SoldToPartyModSet").refresh();var t=this.CustCodeFrag.getModel("SoldToPartyListSet");if(t!==undefined){this.CustCodeFrag.getModel("SoldToPartyListSet").setData([]);this.CustCodeFrag.getModel("SoldToPartyListSet").refresh(true)}},onLiveChange:function(e){var t;if(e.getParameters().newValue===undefined){t=e.getParameters().query}else{t=e.getParameters().newValue}var s=[];var a=new sap.ui.model.Filter([new sap.ui.model.Filter("custCode",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("salesOrg",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("sOrgName",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("titleInLocalName",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("nameInTH",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("nameInEN",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("channel",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("city",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("province",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("postCode",sap.ui.model.FilterOperator.Contains,t)]);s.push(a);var r=this.getView().byId("tableId").getBinding("items");r.filter(s)},onPressCollapse:function(){this.getView().getModel("baseModel").setProperty("/openVisiblity",true);this.getView().getModel("baseModel").setProperty("/CollapseVisiblity",false);this.getView().getModel("baseModel").setProperty("/SearchVisiblity",false)},onPressOpen:function(){this.getView().getModel("baseModel").setProperty("/openVisiblity",false);this.getView().getModel("baseModel").setProperty("/CollapseVisiblity",true);this.getView().getModel("baseModel").setProperty("/SearchVisiblity",true)},onExport:function(){var e=this.getView().getModel("oTableModel").getData().results;for(var t=0;t<e.length;t++){e[t].cSalesOrg=e[t].sOrgName?e[t].salesOrg+"("+e[t].sOrgName+")":e[t].salesOrg;e[t].cName=e[t].nameInTH?e[t].titleInLocalName+"("+e[t].nameInTH+")":e[t].nameInTH;e[t].cchannel=e[t].channel?e[t].channel+"("+e[t].dcName+")":e[t].channel}var s=[{label:"Customer Code",property:"custCode"},{label:"Sales Org",property:"cSalesOrg"},{label:"Name (Local)",property:"cName"},{label:"Name EN",property:"nameInEN"},{label:"Dist Channel",property:"cchannel"},{label:"City",property:"city"},{label:"Province",property:"province"},{label:"Post Code",property:"postCode"}];var s,a,r;s=s;a={workbook:{columns:s},dataSource:e,showProgress:false};r=new o(a);r.build().then(function(){}).finally(function(){r.destroy()})}})});